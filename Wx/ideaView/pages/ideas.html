<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Idea List</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--   import css -->
    <link rel="stylesheet" href="../lib/weui.min.css">
    <link rel="stylesheet" href="../css/jquery-weui.css">
    <link rel="stylesheet" href="../demos/css/demos.css">
    <link rel="stylesheet" href="../css/common.css">
    <script>
        var ideas = {"total": 20,"currentPage":1,"totalPAge":3,"data":[
            {
                "id"
                        :
                        0, "idea"
                    :
                    "LobbyView", "name"
                    :
                    "Jacky", "time"
                    :
                    "2016-12-09", "like"
                    :
                    0
            }
            ,
            {
                "id"
                        :
                        1, "idea"
                    :
                    "LobbyView", "name"
                    :
                    "Jacky", "time"
                    :
                    "2016-12-09", "like"
                    :
                    0
            },
            {
                "id"
                        :
                        2, "idea"
                    :
                    "LobbyView", "name"
                    :
                    "Jacky", "time"
                    :
                    "2016-12-09", "like"
                    :
                    0
            },
            {
                "id"
                        :
                        3, "idea"
                    :
                    "LobbyView", "name"
                    :
                    "Jacky", "time"
                    :
                    "2016-12-09", "like"
                    :
                    2
            },
            {
                "id"
                        :
                        4, "idea"
                    :
                    "LobbyView", "name"
                    :
                    "Jacky", "time"
                    :
                    "2016-12-09", "like"
                    :
                    1
            }]
        };
        var data = ideas.data;

    </script>
</head>
<body ontouchstart>
<div class="weui_tab">
    <div class="weui_tab_bd">
        <div id="nav1" class="weui_tab_bd_item weui_tab_bd_item_active">
            <div class="panels">
                <div class="page__hd">
                    <h6 class="page__title">Idea List</h6>
                </div>
                <!--<div class="weui_panel" id="idea1">-->
                    <!--<div class="weui_panel_bd">-->
                        <!--<div class="weui-row weui-no-gutter">-->
                            <!--<div class="panelLeft">-->
                                <!--<div class="weui_media_box weui_media_text">-->
                                    <!--&lt;!&ndash;<h4 class="weui_media_title">Idea Title</h4>&ndash;&gt;-->
                                    <!--<p class="weui_media_desc"><a href="idea.html">Idea Title</a></p>-->
                                    <!--<ul class="weui_media_info">-->
                                        <!--<li class="weui_media_info_meta">Jacky</li>-->
                                        <!--<li class="weui_media_info_meta">2016-12-09</li>-->
                                        <!--<li class="weui_media_info_meta weui_media_info_meta_extra"><a href="idea.html">详细信息</a></li>-->
                                    <!--</ul>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="panelRight">-->
                                <!--<a href="javascript:;" class="imgContainer" onclick="good(1)">-->
                                    <!--<img class="imgIcon img1" src="../img/goodn.png" alt="">-->
                                <!--</a>-->
                                <!--<a href="javascript:;" class="imgContainer" onclick="bad(1)">-->
                                    <!--<img class="imgIcon img2" src="../img/badn.png" alt="">-->
                                <!--</a>-->
                            <!--</div>-->
                        <!--</div>-->

                    <!--</div>-->
                <!--</div>-->
            </div>
        </div>
        <div id="nav2" class="weui_tab_bd_item">
            <h1 class="doc-head">通讯录</h1>
        </div>
        <div id="nav3" class="weui_tab_bd_item">
            <h1 class="doc-head">发现</h1>
        </div>
        <div id="nav4" class="weui_tab_bd_item">
            <h1 class="doc-head">我的</h1>
        </div>
    </div>
    <div class="weui_navbar">
        <a id="r1" href="#nav1" class="weui_navbar_item weui_bar_item_on">
            R1
        </a>
        <a id="r2" href="#nav2" class="weui_navbar_item">
            R2
        </a>
        <a id="r3" href="#nav3" class="weui_navbar_item">
            R3
        </a>
        <a id="r4" href="#nav4" class="weui_navbar_item">
            R4
        </a>
    </div>
</div>



<!-- import js-->
<script src="../lib/jquery-2.1.4.js"></script>
<script src="../lib/fastclick.js"></script>
<script src="../js/jquery-weui.js"></script>
<script>
    $(function() {
        FastClick.attach(document.body);
    });
    //like this idea
    function good(index) {
        if(check(index))
        {
            $.toast("Good");
            //ajax
            //
            data[index].like = 1;
            $("#idea"+index +" .img1").attr("src","../img/good.png");
        }
        else {
            $.toast("Unchangable");
        }
    }
    //unlike this idea
    function bad(index) {
        if(check(index))
        {
            $.toast("Bad");
            //ajax
            //
            data[index].like = 2;
            $("#idea"+index +" .img2").attr("src","../img/bad.png");
        }
        else {
            $.toast("Unchangable");
        }
    }
    //    check whether this idea evaluated
    function check(index) {
        if(data[index].like == 0) return true;
        else return false;
    }
    //R1 onclick function
    $("#r1").bind("click",function (event) {
        alert("R1");
        //dynamic loading the data
        $.each(data,function (i,obj) {
            var imgGood;
            var imgBad;
            if(obj.like == 0){
                //no option
                imgBad = "badn";
                imgGood = "goodn";
            }
            else if(obj.like == 1){
                //like
                imgBad = "badn";
                imgGood = "good";
            }
            else if(obj.like == 2){
                //unlike
                imgBad = "bad";
                imgGood = "goodn";
            }
            var panel =" <div class=\"weui_panel\" id=\"idea" + i + "\" data-id='" + i +
                    "'\">"+
                    "                    <div class=\"weui_panel_bd\">"+
                    "                        <div class=\"weui-row weui-no-gutter\">"+
                    "                            <div class=\"panelLeft\">"+
                    "                                <div class=\"weui_media_box weui_media_text\">"+
                    "                                    <p class=\"weui_media_desc\"><a href=\"idea.html\">" + obj.idea +
                    "                                       </a></p><ul class=\"weui_media_info\">"+
                    "                                        <li class=\"weui_media_info_meta\">" + obj.name +
                    "                                        </li><li class=\"weui_media_info_meta\">"+ obj.time +"</li>"+
                    "                                        <li class=\"weui_media_info_meta weui_media_info_meta_extra\"><a href=\"idea.html\">详细信息</a></li>"+
                    "                                    </ul>"+
                    "                                </div>"+
                    "                            </div>"+
                    "                            <div class=\"panelRight\">"+
                    "                                <a href=\"javascript:;\" class=\"imgContainer\" onclick=\"good("+i+")\">"+
                    "                                    <img class=\"imgIcon img1\" src=\"../img/"+ imgGood +".png\" alt=\"\">"+
                    "                                </a>"+
                    "                                <a href=\"javascript:;\" class=\"imgContainer\" onclick=\"bad("+i+")\">"+
                    "                                    <img class=\"imgIcon img2\" src=\"../img/"+ imgBad +".png\" alt=\"\">"+
                    "                                </a>"+
                    "                            </div>"+
                    "                        </div>"+
                    "                    </div>"+
                    "                </div>";
            $(".panels").append(panel);
        });


    });

    function test() {
        $.alert(JSON.stringify(data));
    }
    test();
    $("#r1").click();
</script>
</body>
</html>